<!DOCTYPE html>    <html>  <head>    <title>pages.js</title>    <meta http-equiv="content-type" content="text/html; charset=UTF-8">    <link rel="stylesheet" media="all" href="../docco.css" />  </head>  <body>    <div id="container">      <div id="background"></div>              <div id="jump_to">          Jump To &hellip;          <div id="jump_wrapper">            <div id="jump_page">                                              <a class="source" href="../config.html">                  config.html                </a>                                              <a class="source" href="../ext/github.html">                  ext/github.html                </a>                                              <a class="source" href="../ext/json.html">                  ext/json.html                </a>                                              <a class="source" href="../ext/pages.html">                  ext/pages.html                </a>                                              <a class="source" href="../model/posts.html">                  model/posts.html                </a>                                              <a class="source" href="../nabe.html">                  nabe.html                </a>                                              <a class="source" href="../renderer.html">                  renderer.html                </a>                                              <a class="source" href="../routes.html">                  routes.html                </a>                                              <a class="source" href="../util.html">                  util.html                </a>                          </div>          </div>        </div>            <table cellpadding="0" cellspacing="0">        <thead>          <tr>            <th class="docs">              <h1>                pages.js              </h1>            </th>            <th class="code">            </th>          </tr>        </thead>        <tbody>                                  <tr id="section-1">              <td class="docs">                <div class="pilwrap">                  <a class="pilcrow" href="#section-1">&#182;</a>                </div>                <p>pages, such as home, about, etc. go in the <code>templates/pages</code> folder. 
It basically allows one to render a simple <code>about.html</code> to <code>/about</code> url. </p>              </td>              <td class="code">                <div class="highlight"><pre><span class="pln"><br /></span></pre></div>              </td>            </tr>                                  <tr id="section-2">              <td class="docs">                <div class="pilwrap">                  <a class="pilcrow" href="#section-2">&#182;</a>                </div>                <p>One can easily add pages just by creating new files in <code>pages</code> folder.</p>              </td>              <td class="code">                <div class="highlight"><pre><span class="pln"><br /></span><span class="kwd">var</span><span class="pln"> connect </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'connect'</span><span class="pun">),</span><span class="pln"><br />fs </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'fs'</span><span class="pun">),</span><span class="pln"><br />config </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'../config'</span><span class="pun">),</span><span class="pln"><br />util </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'../util'</span><span class="pun">),</span><span class="pln"><br />renderer </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">require</span><span class="pun">(</span><span class="str">'../renderer'</span><span class="pun">);</span><span class="pln"><br /><br /></span></pre></div>              </td>            </tr>                                  <tr id="section-3">              <td class="docs">                <div class="pilwrap">                  <a class="pilcrow" href="#section-3">&#182;</a>                </div>                <h2>Pages layer</h2>

<p>A custom connect layer. It exports a function to be passed in a <code>use</code> call.
This function returns a connect.router with the following
available</p>              </td>              <td class="code">                <div class="highlight"><pre><span class="kwd">var</span><span class="pln"> pages </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">module</span><span class="pun">.</span><span class="pln">exports </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> pages</span><span class="pun">(</span><span class="pln">o</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; <br />&nbsp; console</span><span class="pun">.</span><span class="pln">log</span><span class="pun">(</span><span class="str">'init pages layer &gt; '</span><span class="pun">,</span><span class="pln"> o</span><span class="pun">);</span><span class="pln"><br />&nbsp; <br />&nbsp; </span><span class="kwd">return</span><span class="pln"> connect</span><span class="pun">.</span><span class="pln">router</span><span class="pun">(</span><span class="kwd">function</span><span class="pun">(</span><span class="pln">app</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; <br /></span></pre></div>              </td>            </tr>                                  <tr id="section-4">              <td class="docs">                <div class="pilwrap">                  <a class="pilcrow" href="#section-4">&#182;</a>                </div>                <h3><code>GET /:filename</code></h3>

<p>returns page file in the <code>templates/pages</code> directory.</p>              </td>              <td class="code">                <div class="highlight"><pre><span class="pln">&nbsp; &nbsp; app</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="str">'/:file'</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">function</span><span class="pun">(</span><span class="pln">req</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> url </span><span class="pun">=</span><span class="pln"> req</span><span class="pun">.</span><span class="pln">url</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; file </span><span class="pun">=</span><span class="pln"> </span><span class="str">'page.'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> req</span><span class="pun">.</span><span class="kwd">params</span><span class="pun">.</span><span class="pln">file </span><span class="pun">+</span><span class="pln"> </span><span class="str">'.html'</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; tmpl </span><span class="pun">=</span><span class="pln"> </span><span class="str">'tmpl.'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> file</span><span class="pun">,</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; hasTmpl </span><span class="pun">=</span><span class="pln"> util</span><span class="pun">.</span><span class="pln">hasTmpl</span><span class="pun">(</span><span class="pln">tmpl</span><span class="pun">);</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br /></span></pre></div>              </td>            </tr>                                  <tr id="section-5">              <td class="docs">                <div class="pilwrap">                  <a class="pilcrow" href="#section-5">&#182;</a>                </div>                <p>if requested page does not exist, pass control
to the next middleware in the stack</p>              </td>              <td class="code">                <div class="highlight"><pre><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">hasTmpl</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">next</span><span class="pun">();}</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; <br /></span></pre></div>              </td>            </tr>                                  <tr id="section-6">              <td class="docs">                <div class="pilwrap">                  <a class="pilcrow" href="#section-6">&#182;</a>                </div>                <p>render file and end response</p>              </td>              <td class="code">                <div class="highlight"><pre><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; renderer</span><span class="pun">.</span><span class="pln">render</span><span class="pun">(</span><span class="pln">file</span><span class="pun">,</span><span class="pln"> res</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln">headers</span><span class="pun">:</span><span class="pln"> req</span><span class="pun">.</span><span class="pln">headers</span><span class="pun">,</span><span class="pln"> content</span><span class="pun">:</span><span class="pln"> util</span><span class="pun">.</span><span class="pln">toHtml</span><span class="pun">(</span><span class="pln">tmpl</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; config</span><span class="pun">:</span><span class="pln"> renderer</span><span class="pun">.</span><span class="pln">options<br />&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">})});</span><span class="pln"><br />&nbsp; &nbsp; </span><span class="pun">});</span><span class="pln"><br />&nbsp; &nbsp; <br />&nbsp; </span><span class="pun">});</span><span class="pln"><br /></span><span class="pun">};</span><span class="pln"><br /></span></pre></div>              </td>            </tr>                  </tbody>      </table>    </div>  </body>  </html>